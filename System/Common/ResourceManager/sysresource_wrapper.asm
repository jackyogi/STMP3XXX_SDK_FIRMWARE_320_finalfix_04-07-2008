;///////////////////////////////////////////////////////////////////////////////
;  Copyright(C) SigmaTel, Inc. 2000-2003
;
;  File        : sysresource_wrapper.asm
;  Description : Wrapper for C function SysLoadResource
;///////////////////////////////////////////////////////////////////////////////

    page    132,60,0,0,0
    opt     mex

    section SysLoadResource

;///////////////////////////////////////////////////////////////////////////////
;   Macros
;///////////////////////////////////////////////////////////////////////////////

    nolist
    include "sysmacro.asm"
    list
        
;///////////////////////////////////////////////////////////////////////////////
;   Includes
;///////////////////////////////////////////////////////////////////////////////

;///////////////////////////////////////////////////////////////////////////////
;   External Definitions
;///////////////////////////////////////////////////////////////////////////////

    global  SysLoadResource

;///////////////////////////////////////////////////////////////////////////////
;   External References
;///////////////////////////////////////////////////////////////////////////////

    extern  FSysLoadResource
    
;///////////////////////////////////////////////////////////////////////////////
;   Equates
;///////////////////////////////////////////////////////////////////////////////

;///////////////////////////////////////////////////////////////////////////////
;   X Memory
;///////////////////////////////////////////////////////////////////////////////
        
;///////////////////////////////////////////////////////////////////////////////
;   Y Memory
;///////////////////////////////////////////////////////////////////////////////
        
;///////////////////////////////////////////////////////////////////////////////
;   P Memory
;///////////////////////////////////////////////////////////////////////////////

    org     p,"SysLoadResource_P":

;///////////////////////////////////////////////////////////////////////////////
;
;>  Name:           SysLoadResource
;
;   Type:           Function
;
;   Description:    Load a resource from resource.bin
;
;   Inputs:         x0 = Resource Number
;                   x1 = Resource Type
;                   y0 = Target Pointer
;                   y1 = Target available space (in Bytes)
;                   a1 = Space target << 16
;
;   Outputs:        If successful:
;                       sr.Carry = Clear
;                   If unsuccessful:
;                       sr.Carry = Set
;                   
;   Notes:          ???
;<
;///////////////////////////////////////////////////////////////////////////////
SysLoadResource
    push    ssh
    
    push    a1
    move    x0,a
    clr     b       ; Only loads resources from the root resource
    move    x1,x0
    move    y0,r0
    pop     y0
    move    y1,x1
    
    jsr     FSysLoadResource		;//NC, Success => return 0, Error => return non-zero
    bclr	#0,sr			; //NC
    tst		a				; //NC
    jeq		_success		; //NC
    bset	#0,sr			; //NC , Set carry flag to indicate error
_success    
    pop     ssh
    nop
    rts
    
    

    endsec


