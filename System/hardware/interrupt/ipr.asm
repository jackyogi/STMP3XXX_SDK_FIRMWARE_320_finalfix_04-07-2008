;///////////////////////////////////////////////////////////////////////////////
;  Copyright(C) SigmaTel, Inc. 2000-2001
;
;  File        : budesc.asm
;  Description : STMP3 Buffer Routines (System Routines)
;///////////////////////////////////////////////////////////////////////////////

    section IPR

;///////////////////////////////////////////////////////////////////////////////
;   Macros
;///////////////////////////////////////////////////////////////////////////////

    nolist
    include "sysmacro.asm"
    list

;///////////////////////////////////////////////////////////////////////////////
;   Includes
;///////////////////////////////////////////////////////////////////////////////

    nolist
    include "const.xref"
    include "regsicoll.inc"
    list       

;///////////////////////////////////////////////////////////////////////////////
;   External Definitions
;///////////////////////////////////////////////////////////////////////////////
    
    GLOBAL IPRSetIVLPriority
    
    
        
;///////////////////////////////////////////////////////////////////////////////
;   P Memory
;///////////////////////////////////////////////////////////////////////////////
    org p,".ptextipr":

;_asmfunc WORD IPRSetIVLPriority(WORD wIVL, WORD wPriority)
IPRSetIVLPriority
    move x:HW_IPR,y0 
    move y:<Const_000003,x0 
    and     x0,b    y:<Const_000003,y1
    move    b1,b    
    move    x0,b0
    tst a   a1,x1
    jeq _norotate
    rep a
        rol b
_norotate
    move b1,x:HW_IPR
    rts

    endsec